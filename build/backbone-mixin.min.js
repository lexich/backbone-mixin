var MixinBackbone;MixinBackbone=function(){var a;return MixinBackbone=function(b){return b.extend({_diViews:{},_currentView:null,setElement:function(){return b.prototype.setElement.apply(this,arguments),this.__$_$removeFlag=!1,this.reloadTemplate(),this.bindUIElements(),this.bindRegions(),this.bindUIEpoxy()},remove:function(){return this.__$_$removeFlag===!0?this:(this.__$_$removeFlag=!0,b.prototype.remove.apply(this,arguments),this.unbindRegions(),this.unbindUIElements(),_.each(this._diViews,function(a){return a.remove()}),this._diViews={})},delegateEvents:function(a){var c;return a||(a=_.result(this,"events")),null!=this.__bindUIElements&&null!=a&&(a=_.reduce(a,function(a){return function(b,c,d){var e,f,g,h,i;if(f=d.match(/@ui\.[^ ,]+/g),null!=f)for(h=0,i=f.length;i>h;h++)e=f[h],null!=/@ui\.([^ ,]+)/.exec(e)&&(g=a.__bindUIElements[RegExp.$1],d=d.replace(e,g));return b[d]=c,b}}(this),{})),null!=(c=b.prototype.delegateEvents)?c.call(this,a):void 0},setNeedRerenderView:function(a){return a._$_oneShow=null},setNeedRerender:function(){return this.setNeedRerenderView(this)},show:function(a,b){return null==b&&(b={}),null!=a?(this!==this._currentView?this.close(this._currentView):this._currentView=null,a=this.getViewDI(a,b),this._currentView=a,this.$el.append(a.$el),null==a._$_oneShow&&(a._$_oneShow=!0,"function"==typeof a.render&&a.render()),"function"==typeof a.onBeforeShow&&a.onBeforeShow(),null!=a.regions&&_.each(a.regions,function(b,c){return a[c].show(a[c])}),this.showViewAnimation(a),"function"==typeof a.onShow&&a.onShow(),a):void 0},close:function(a){return null!=a?(this._currentView!==a&&this.close(this._currentView),this._currentView=null,null!=a.regions&&_.each(a.regions,function(b,c){var d;return d=a[c],d.close(d)}),"function"==typeof a.onBeforeClose&&a.onBeforeClose(),this.closeViewAnimation(a),"function"==typeof a.onClose?a.onClose():void 0):void 0},showAnimation:function(){return this.showViewAnimation(this)},closeAnimation:function(){return this.closeViewAnimation(this)},showViewAnimation:function(a){return null!=a?null!=a.showAnimation&&a!==this?a.showAnimation():a.$el.show():void 0},closeViewAnimation:function(a){return null!=a?null!=a.closeAnimation&&a!==this?a.closeAnimation():a.$el.hide():void 0},getViewDI:function(a,b){var c,d;return null==b&&(b={}),null!=a.cid?(c=a.constructor,d=a.cid,this._diViews[d]=a):"function"==typeof a?(c=a,d=c.prototype._$_di||(c.prototype._$_di=_.uniqueId("_$_di"))):(c=a.type,c.prototype._$_di||(c.prototype._$_di=_.uniqueId("_$_di")),d=a.key),null==this._diViews[d]&&(this._diViews[d]=new c(b)),this._diViews[d]},reloadTemplate:function(){var a,b,c;if(c=null,b=null,null!=this.template){if(a=$(this.template),!a.length)return;c=a.html()}return null!=this.templateData&&(b=_.result(this,"templateData"),null!=this.templateFunc||(this.templateFunc=_.template)),null!=this.templateFunc?this.$el.html(this.templateFunc(c,b)):null!=c?this.$el.html(c):void 0},unbindRegions:function(){return this.regions?_.each(this.regions,function(a){return function(b,c){return a[c].remove(),delete a[c]}}(this)):void 0},bindRegions:function(){return this.regions?_.each(this.regions,function(b){return function(c,d){var e,f;return _.isObject(c)?(f=_.isString(c.el)?b.$el.find(c.el):f=c.el,e=c.view):(f=b.$el.find(c),e=a),null!=b[d]?b[d].setElement(f):b[d]=new e({el:f})}}(this)):void 0},bindUIElements:function(){return null!=this.ui?(this.unbindUIElements(),this.__bindUIElements=_.extend({},this.ui),this.ui={},_.each(this.__bindUIElements,function(a){return function(b,c){return a.ui[c]=a.$el.find(b)}}(this))):void 0},unbindUIElements:function(){return null!=this.__bindUIElements?this.ui=_.extend({},this.__bindUIElements):void 0},bindUIEpoxy:function(){var a;if(this.bindings)return this.unbindUIEpoxy(),this.__bindings=this.bindings,a=/@ui\.([^ ]+)/,this.bindings=_.reduce(this.__bindings,function(b){return function(c,d,e){var f,g;return null!=a.exec(e)?(g=b.__bindUIElements[RegExp.$1],f=e.replace(a,g),c[f]=d):c[e]=d,c}}(this),{})},unbindUIEpoxy:function(){return null!=this.__bindings?this.bindings=_.extend({},this.__bindings):void 0}})},a=MixinBackbone(Backbone.View).extend({}),MixinBackbone},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define([],function(){return MixinBackbone()}):window.MixinBackbone=MixinBackbone();