var MixinBackbone;MixinBackbone=function(a){var b;return MixinBackbone=function(a){var c,d,e,f,g;return c=null,d={},e=!1,g=null,f=null,a.extend({setElement:function(){return a.prototype.setElement.apply(this,arguments),this.reloadTemplate(),this.bindUIElements(),this.bindRegions(),this.bindUIEpoxy()},remove:function(){var b,c;if(e===!0)return this;e=!0,a.prototype.remove.apply(this,arguments),this.unbindRegions(),this.unbindUIElements();for(b in d)c=d[b],c.remove();return d={}},_diViewsKeys:function(){return _.keys(d)},_diViewsValues:function(){return _.values(d)},delegateEvents:function(b){var c;return b||(b=_.result(this,"events")),null!=g&&null!=b&&(b=_.reduce(b,function(){return function(a,b,c){var d,e,f,h,i;if(e=c.match(/@ui\.[^ ,]+/g),null!=e)for(h=0,i=e.length;i>h;h++)d=e[h],null!=/@ui\.([^ ,]+)/.exec(d)&&(f=g[RegExp.$1],c=c.replace(d,f));return a[c]=b,a}}(this),{})),null!=(c=a.prototype.delegateEvents)?c.call(this,b):void 0},setNeedRerenderView:function(a){return a._$_oneShow=null},setNeedRerender:function(){return this.setNeedRerenderView(this)},show:function(a,b){var d;return null==b&&(b={}),null!=a?(this!==c?this.close(c):c=null,d=this.getViewDI(a,b),this!==d&&(c=d),this.$el.append(d.$el),d.showCurrent(),d):void 0},showCurrent:function(){var a;return null==this._$_oneShow&&(this._$_oneShow=!0,"function"==typeof this.render&&this.render()),_.result(this,"onBeforeShow"),(a=_.result(this,"regions"))&&_.each(a,function(a){return function(b,c){return a[c].showCurrent()}}(this)),this.showAnimation(),_.result(this,"onShow")},closeCurrent:function(){var a;return(a=_.result(this,"regions"))&&_.each(a,function(a){return function(b,c){return a[c].closeCurrent()}}(this)),_.result(this,"onBeforeClose"),this.closeAnimation(),_.result(this,"onClose")},close:function(a){return null!=a?(null!=c&&c!==a&&this.close(c),c=null,a.closeCurrent(),a):void 0},showAnimation:function(){return this.showViewAnimation(this)},closeAnimation:function(){return this.closeViewAnimation(this)},showViewAnimation:function(a){return null!=a?null!=a.showAnimation&&a!==this?a.showAnimation():a.$el.show():void 0},closeViewAnimation:function(a){return null!=a?null!=a.closeAnimation&&a!==this?a.closeAnimation():a.$el.hide():void 0},getViewDI:function(a,b){var c,e;return null==b&&(b={}),null!=a.cid?(c=a.constructor,e=a.cid,d[e]=a):"function"==typeof a?(c=a,e=c.prototype._$_di||(c.prototype._$_di=_.uniqueId("_$_di"))):(c=a.type,c.prototype._$_di||(c.prototype._$_di=_.uniqueId("_$_di")),e=a.key),null==d[e]&&(d[e]=new c(b)),d[e]},reloadTemplate:function(){var a,b,c;if(c=null,b=null,null!=this.template){if(a=$(this.template),!a.length)return;c=a.html()}return null!=this.templateData&&(b=_.result(this,"templateData"),null!=this.templateFunc||(this.templateFunc=_.template)),null!=this.templateFunc?this.$el.html(this.templateFunc(c,b)):null!=c?this.$el.html(c):void 0},unbindRegions:function(){var a,b,c,d;if(this.regions){c=this.regions,d=[];for(a in c)b=c[a],this[a].remove(),d.push(delete this[a]);return d}},bindRegions:function(){var a,c,d,e,f,g;if(this.regions){f=this.regions,g=[];for(d in f)e=f[d],_.isObject(e)?(c=_.isString(e.el)?this.$el.find(e.el):c=e.el,a=e.view):(c=this.$el.find(e),a=b),g.push(null!=this[d]?this[d].setElement(c):this[d]=new a({el:c}));return g}},bindUIElements:function(){var a,b,c;if(null!=this.ui){this.unbindUIElements(),g=_.extend({},this.ui),this.ui={},c=[];for(a in g)b=g[a],c.push(this.ui[a]=this.$el.find(b));return c}},unbindUIElements:function(){return null!=g?(this.ui=g,g=null):void 0},bindUIEpoxy:function(){var a;if(this.bindings)return this.unbindUIEpoxy(),f=this.bindings,a=/@ui\.([^ ]+)/,this.bindings=_.reduce(f,function(){return function(b,c,d){var e,f;return null!=a.exec(d)?(f=g[RegExp.$1],e=d.replace(a,f),b[e]=c):b[d]=c,b}}(this),{})},unbindUIEpoxy:function(){return null!=f?(this.bindings=f,f=null):void 0}})},b=MixinBackbone(a.View).extend({}),MixinBackbone},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(["backbone"],function(a){return MixinBackbone(a)}):window.MixinBackbone=MixinBackbone(Backbone);